<% content_for :title, "Time Entries" %>
<% content_for :actions do %>
  <% link_to "Novo Lançamento", new_user_time_entry_path(@user), class: "btn btn-primary" %>
<% end %>
<% breadcrumb :time_entries, @user %>

<div class="ibox float-e-margins">
  <%= render partial: "layouts/float_header", locals: { title: "Lançamentos" } %>
  <div class="ibox-content">
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>Data</th>
            <th>Período</th>
            <th>Quantidade</th>
            <th>Projeto</th>
            <th>Memo</th>
            <th class="actions"></th>
          </tr>
        </thead>
        <tbody>
          <%
            total = 0.0
            @time_entries.each do |te| %>
            <tr>
              <td><%= link_to te.id, te %></td>
              <td>
                <strong><%= link_to te.starts_at.strftime("%d/%m/%Y"), te %></strong><br />
                <strong><%= link_to te.ends_at.strftime("%d/%m/%Y"), te if te.starts_at.to_date != te.ends_at.to_date %></strong>
              </td>
              <td>
                <%= te.starts_at.strftime("%H:%M:%S") %><br />
                <%= te.ends_at.strftime("%H:%M:%S") %>
              </td>
              <td>
                <%= te.duration %>
              </td>
              <td>
                <%= link_to te.task.project.name, te.task.project %><br />
                <small><%= link_to te.task.name, te.task %></small>
              </td>
              <td>
                <%= te.memo %>
              </td>
              <td class="project-actions">
                <%= actions(te) %>
              </td>
            </tr>
            <% total += te.duration %>
          <% end %>
        </tbody>
        <tfoot>
          <tr class="info">
            <th colspan="3" style="text-align: right;">Total</th>
            <th><%= total %> horas</th>
            <th colspan="3" style="text-align: right;"><%= @time_entries.size %> registro(s).</th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>